==========================================
よくある質問と回答
==========================================

.. note::
  エフェクトに関する質問は「:doc:`faq_effect`」を参照

nanoem を使う際において聞かれそうなこととその回答の一覧です。問題が起きた場合の対処については「:doc:`trouble_shooting`」にまとめています。

ここに書かれてることが含まれてない場合は「:ref:`37420267-8E5A-41EA-A159-FFF490DF1D8D`」を参照して質問を投げてください。

.. caution::
   Twitter で `#nanoem <https://twitter.com/search?q=#nanoem>`_ または `#nanoem互助会 <https://twitter.com/search?q=#nanoem互助会>`_ タグをつけてツイートする方法もありますが、こちらは開発者本人からの回答は行わないためご注意ください。

MikuMikuDance の違いはなんですか？
=======================================================

.. important::
   nanoem は MikuMikuDance の互換実装ではありますが、 **MikuMikuDance ではありません。** よって MikuMikuDance の代わりにはなりません。

   互換あるいはそれに類するモーション編集が可能な実装は他にも以下があります。

   * `MikuMikuMoving <https://sites.google.com/site/mikumikumoving/>`_ （略称として MMM）
   * `NexGiMa <https://sites.google.com/view/nexgima/Home>`_

   いずれも DirectX をベースとしているため Windows のみの対応です。

* nanoem は DirectX11 をつかうが、MikuMikuDance は DirectX9 をつかう
* 見た目は MikuMikuDance に似ているが細かいところの使い勝手が再現できない
* MikuMikuDance が利用するファイルを一通り読めるがエフェクト、IK 及び物理演算に完全な再現性をもたない

MikuMikuDance の単純な乗り換え先として使おうとするなら２番目及び３番めの理由による問題が大きく出るためやめたほうがよいでしょう。
もし macOS で nanoem ではなく MikuMikuDance を動かしたい場合は :doc:`alternative` を参照してください。

nanoem 特有の特徴は以下です。

* DirectX11 を利用しつつも独自実装のエフェクト読込機能により MME との互換性を確保

  * これは MME で使われる技術は DirectX9 に依存しており DirectX11 で利用することができないためです

    * MMM でも DirectX11 版は独自形式のエフェクトで MME を利用することができません

  * すべての MME のエフェクトに対応しているわけではなく読み込めないものもあります

* モデル編集機能の統合

  * MikuMikuDance にも部分的に存在しますが物理演算関連に限定されます

* 高解像度モニターかつ Per-Monitor V2 によりモニター毎に DPI が違うものでも対応
* ARM64 に一応ネイティブ対応

モデル編集できますか？
=======================================================

33.0 からある程度可能になりました。ただしモデル編集におけるデファクトスタンダードであり実質唯一の実装である PMXEditor とは操作方法が大きく異なるため同じ使い勝手で利用することはできません。
また PMXEditor のプラグインを利用することができません（例外として「:ref:`CCDE11E1-3416-425D-80DF-A347F79E7BDD`」はあります）。

モデル編集が出来るとはいえ PMXEditor と同じく原則として予めある程度モデルが出来た状態からの利用を想定しており、ゼロから作るのは困難を極めます。
そのため以下に挙げるモデリングが可能なソフトウェアを利用して X/PMD/PMX 形式のいずれかに変換してから nanoem に持ってきてください。
いずれも Windows/macOS に対応しています。

- `Blender <http://www.blender.org>`_

  - `mmd_tools <https://github.com/powroupi/blender_mmd_tools>`_ アドオンの導入が必要です c.f. `【Blender 2.8】MMDモデルやモーションをBlenderにインポートできるアドオン「mmd_tools」 <https://3dcgmodel-info.com/blender-2-8-addon-mmdtools/>`_
  - mmd_tools 導入時 ``Shared Toon Textures`` の設定で必要な共有テクスチャのフォルダはありません

    - これは nanoem がアプリケーションに直接共有テクスチャを組み込んでるためです
    - そのため MikuMikuDance をダウンロードして解凍し、その中にある ``Data`` フォルダのパスを指定してください

- `Metasequoia <http://www.metaseq.net>`_

  - PMD (not PMX) 形式で出力するには有償版が必要です

- `Xismo <http://mqdl.jpn.org>`_

  - ver 2.0 以降は macOS に対応していません
  - ver 1.x でも OpenGL を利用しているため将来的には動作しなくなる可能性があります

- `VRoid Studio <https://studio.vroid.com/>`_

  - 書き出しは VRM のみで「:ref:`EFC55993-3D0E-4D90-855F-860FBBA5A90F`」で解説してる通り直接 nanoem で読み込むことはできません

.. _28185A65-88E5-4C4C-BF60-41BBB5520B70:

動画編集できますか？
=======================================================

できません。動画編集をしたい場合は以下に挙げる動画編集を目的とするソフトウェアを利用してください。

- macOS

  - `iMovie <https://www.apple.com/jp/imovie/>`_
  - `Final Cut Pro <https://www.apple.com/jp/final-cut-pro/>`_ 🈶
  - `Adobe Premier Pro <https://www.adobe.com/jp/products/premiere.html>`_ 🈶
  - `DaVinch Resolve <https://www.blackmagicdesign.com/jp/products/davinciresolve/>`_
  - `Javie <https://ja.osdn.net/projects/javie/>`_
  - `OpenShot Video Editor <https://www.openshot.org>`_
  - `Avidemux <http://avidemux.sourceforge.net>`_

- Windows

  - `Adobe Premier Pro <https://www.adobe.com/jp/products/premiere.html>`_ 🈶
  - `AviUtl <http://spring-fragrance.mints.ne.jp/aviutl/>`_
  - `DaVinch Resolve <https://www.blackmagicdesign.com/jp/products/davinciresolve/>`_
  - `OpenShot Video Editor <https://www.openshot.org>`_
  - `Avidemux <http://avidemux.sourceforge.net>`_

※ 🈶 とついてるものは有償版のみ

講座動画はありますか？
=======================================================

ありません。また、作る予定もありません。本人曰く作るコストが見合わないことを理由としています。

商用利用は可能ですか？
=======================================================

まず大前提として権利関係は掛け算、厳密にいうと論理積であるためどれかひとつでも利用条件を満たさなければその時点で NG となります。
これはつまりプロジェクト内で利用したモデル、モーション、アクセサリ、エフェクト、音源、背景動画など全ての利用条件を満たさなければなりません。

これらを踏まえたうえで書くとそれらの利用条件を満たしたうえであれば MikuMikuDance と同様で nanoem 自体は商用利用について許可をとる必要はありません。

最新版で作成したプロジェクトを過去版で読み込むことはできますか？
=======================================================

ファイル形式が nmm の場合であればできます。保存も基本的に可能ですが、最新版のプロジェクトのデータが欠落したり異常な状態で保存されることがあるため過去版で保存する際は別名で保存してください。

それ以外の形式の場合は最新版で保存したデータを過去版での読み込みも保存も一切保証していないので仮に出来ても極力避けてください。

MMD のプロジェクトファイルの読み込みはできますか？
=======================================================

できます。プロジェクトファイルの中身によっては不具合が起こるかもしれません。

また、書き出しも可能ですがいくつか制約があります。詳しくは「:ref:`D90328CC-C39A-4854-BB48-B49039D8E31B`」を確認してください。

.. _EFC55993-3D0E-4D90-855F-860FBBA5A90F:

VRoid Studio で作った VRM を読み込むことができますか？
=======================================================

できません。また、今後の実装予定もないので `VRoid→MMDが楽になりました <https://aideq.goat.me/bnbRNcrIfC>`_
または `VRMtoPMXExporterを改めて使ってみました【2019年4月版】 <https://aideq.goat.me/h70ydDLPP2>`_ にある方法で PMX に変換してください。

.. caution::
   上記記事で言及されている ``VRM2PMXConverter`` は Windows 専用ですので macOS 版の場合 ``VRMtoPMXExporter`` を使う方法しかとれません（つまり Unity を使う必要があります）。

上記ツールを使っても配布モーションで事実上必須となる準標準ボーンが作成されません（変換するツール及びバージョンによっては対応している可能性があります）。
その場合は nanoem 用に作られた「:ref:`CCDE11E1-3416-425D-80DF-A347F79E7BDD`」で作成可能です。

.. _1AF55799-DCCF-4989-AA91-C186F073FDA0:

縦長画像あるいは動画を出力したい
=============================================================

正しく出力するためには「ビューポートアスペクト比を維持する」機能のために 26.0 以降が必要ですが以下の手順で縦長動画を出力できます

.. note::
   縦長は主にスマートフォン向けを想定していますが端末毎に解像度がバラバラなので解像度のプリセットとしては用意していません

- 「プロジェクト」＞「ビューポート設定ダイアログを開く」
- 「出力サイズ」を出力したい解像度に変更する
- 画像または動画出力で以下の設定を行う

  - 出力解像度に「ビューポートと同じ」を選択する
  - 「ビューポートアスペクト比を維持する」にチェックする
  - 27.1 未満かつ動画出力の場合「OS 付属のエンコーダを有効にする」のチェックを外す

- OK ボタンを押して出力する

.. _8DE98D42-1894-4002-B629-4D64580EF404:

透過つき動画を出力したい
=============================================================

以下の手順で透過つき動画を書き出せます。

* 「プロジェクト」＞「ビューポート設定ダイアログを開く」
* 「透過背景を有効にする」にチェックを入れる
* 動画出力時に「OS 付属のエンコーダを有効にする」のチェックが外れていることを確認
* ``Plugins`` から ``plugin_ffmpeg`` を選択し、以下を設定する

  * ``Video Codec`` を ``UT Video Codec`` に設定
  * ``Video Pixel Format`` を ``RGBA`` に設定
  * ``Audio Codec`` を ``PCM`` に設定

* OK でファイル名を指定して書き出す

書き出された透過あり動画は

* Windows の場合は `Ut Video Codec Suite <http://umezawa.dyndns.info/wordpress/?cat=28>`_ を導入
* macOS の場合は macOS 向けの動画プレイヤーである `IINA <https://iina.io/>`_ で再生して確認することが可能

.. important::

  上記手順でとくに以下の２項目は両方ともやらないと透過あり動画で書き出されません。

    * 「透過背景を有効にする」にチェックを入れる
    * ``Video Pixel Format`` を ``RGBA`` に設定

  エフェクト（とくにポストエフェクト）についても透過出力に対応するものを使う必要があります。
  対応しているかどうかはエフェクトの README または取扱説明書を確認してください。

.. _2BEF62AC-4929-485B-9909-2BF027EBF2F8:

モーション調整のため最初の部分に無音を挿入したい
=============================================================

nanoem には無音を挿入する機能を持っていません。そのため `Audacity <https://www.audacityteam.org>`_ を利用して以下の記事を参考に無音を挿入してください。

.. note::
   nanoem もとい MMD のモーションは 1 秒を 30 フレームで計算します。そのことから 1 フレームあたりのサンプル数は以下になります。

   * 音源のサンプルレートが 44100Hz の場合は **1470** (= 44100 / 30)
   * 音源のサンプルレートが 48000Hz の場合は **1600** (= 48000 / 30)

   たとえば 5 フレームずらしたい場合で音源のサンプルレートが 44100Hz の場合は **7350** サンプルを指定します。

`Audacityで曲の途中に無音部分を追加する方法！【空白/間を開ける】 <https://aprico-media.com/posts/5741>`_

nanoem をスリープさせるには？
=============================================================

macOS 版の場合は以下のどちらかをとると nanoem のスリープが発生するため CPU/GPU の消費を最小限に抑えることができます。

* nanoem のウィンドウを最小化する
* nanoem のウィンドウの上に別のアプリケーションのウィンドウをかぶせる

Windows 版の場合は nanoem のウィンドウを最小化することで同等の効果が得られます。

MMDAI2/VPVM とはどう違うのですか？
=======================================================

.. note::
   MMDAI2/VPVM とは 2014 年まで配布していた nanoem と同じ開発元による MMD 互換実装です。

   `MMDAgent <http://sourceforge.net/projects/mmdagent/>`_ を源流として macOS に対応するための実装として2010年1月に提供したものが MMDAI で
   それをモーション編集できるように機能追加したものが MMDAI2 です。VPVM は MMDIA2 の基本実装を流用して派生として開発したものです。

   現在はいずれも開発及び保守はすでに行われていません。

できることはほとんど同じですが、以下が大きな違いとしてあります。

* Metal に対応

  * MMDAI2/VPVM は設計上 OpenGL に強く依存するため Metal に対応できない

* MME に対応

  * MMDAI2/VPVM は外部ライブラリを利用しており MME とは互換性がなく、そのため専用のエフェクトファイルを作る必要があり開発負担となっていた

ほかにも MMDAI2/VPVM にはない機能として以下があり、MMDAI2/VPVM における実装上の不具合が nanoem では修正されてたりします。

* PMM 読み込みに対応
* SDEF 対応

あるモデルにモーションをふたつ以上適用したい
=======================================================

.. note::
   1.15 以降は最初からマージが有効になってるため何もする必要はありません

1.14 以前の場合はデフォルトではひとつのモデルにつきひとつのモーションしか適用されませんが、
「キーフレームをマージする」を有効にすることでふたつ以上のモーションを合成することが出来ます。[#f3]_

#. 画面左パネルの「モデル」を開き、適用するモデルを選択する
#. 「モーション」をクリックし、「キーフレームをマージする」を有効にする
#. モーションを読み込む

ダンスモーションとリップモーションが別々になっている場合は上記の方法で行ってください。

古いバージョンがほしい
=======================================================

32.0.0 以降であれば `GitHub の All Releases <https://github.com/hkrn/nanoem/releases/>`_ から入手可能です。これらは bowlroll で配布されたものと同一のものです。

それより前のバージョンでどうしても古いバージョンが欲しい場合はバージョンの指定（※ひとつのみ、複数不可）と古いバージョンを使いたい理由を書いた上で
:doc:`install` の「不具合報告の方法」に従って送信してください。

アンインストールしたい
=======================================================

macOS の場合は `AppCleaner <https://freemacsoft.net/appcleaner/>`_ を使って `nanoem` で検索して見つかったファイルを全て削除してください。

.. warning::
   単に `nanoem.app` をゴミ箱に捨てる方法は未削除ファイルが残るため非推奨です。

Windows の場合は nanoem.exe のあるフォルダと ``%USERPROFILE%\AppData\Roaming\nanoem`` フォルダを一緒にゴミ箱に入れてください。

よろずの質問
=======================================================

nanoem はなんて読みますか？
-------------------------------------------------------

日本語圏においては「なのえむ」です。以下に表をまとめます

================== =========
言語                読み方
================== =========
日本語(ja_JP)       なのえむ
繁體字(zh_TW)       納米 [#f1]_
简体字(zh_CN)       纳米 [#f1]_
한글(ko_KR)         나노에무
================== =========

nanoem 以外の macOS で使える MMD 互換はありますか？
-------------------------------------------------------

MikuMikuDance のように使える、となるとないです。また、おそらく今後も以下の理由からないと思われます。

* そもそも作るのが非常に難しい

  * MikuMikuDance は DirectX のエコシステムがあって成り立つが、それらに相当するものを自前で実装しなければならない
  * さらに GUI アプリケーションやその他の知識も必要で作るのに求められる知識は膨大

    * ゲームとゲームエンジン両方作るくらいの知識が求められます

  * ちなみに `MikuMikuMoving の開発者が macOS 版の対応予定について濁してる <http://ch.nicovideo.jp/mogg/blomaga/ar1284791/9>`_

* macOS の利用人口が少ない

  * OS シェアとして macOS の利用人口は Windows の 1/10 以下しかない

* `VRM <https://vrm-consortium.org/>`_ の登場

  * 人型という制約はあるが、業界標準をベースにしたものであり執筆時点 (2018/5/27) で今後発展が進むものと思われる

ひとことでいえば **ハイリスク・ローリターン** であるということです。

英語で対応できますか？
-------------------------------------------------------

.. note::
   Google Translate などの翻訳をかけて読まれることを想定してここの部分はあえて日本語で書いてます

できますが、原則として日本語で書いたほうが対応が早いです。ただし日本語で書くために機械翻訳を用いるくらいなら英語で書いてください。

日本語/英語以外の対応予定はありますか？
-------------------------------------------------------

公式に対応しているのは日本語と英語のみ [#f2]_ で現段階でないですが、日本語または英語以外の言語に翻訳出来る翻訳者がいればあるかもしれません。

もし日本語または英語以外に翻訳する翻訳者として立候補したい場合は `@shimacpyon <https://twitter.com/shimacpyon>`_ にフィードバックか DM で翻訳者希望の旨を連絡してください。

どんな人が利用していますか？
-------------------------------------------------------

Google Analytics にもとづく利用状況の結果から以下になります（:doc:`privacy` 参照）

- もともと macOS 向けに作られたアプリケーションなので、 macOS 使ってる人が大半
- 約7割が国内（日本）、約3割が国外からで最も多いのが米国

.. [#f1] 本来は「ナノメートル」を意味をするのだが直接的な当て字がわからないので暫定的に相当するものをあてた。ちなみに日本語だと「年貢を納める」になり意味が異なる
.. [#f2] UI 自体は英語に対応しているものの、マニュアルは日本語のみしかないという矛盾
.. [#f3] 原則キーフレームがかぶらないようにすること。もし衝突した場合は先にある方が適用される
